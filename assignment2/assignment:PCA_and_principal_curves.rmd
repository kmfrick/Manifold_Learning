---
title: 'Assignment: PCA and principal curves'
author: "Kevin Frick, Patrick Lutz, and Sonia Petrini"
date: "11/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Assignment: PCA and principal curves

Reading the data:
```{r}
zip.train <- read.table("zip.train")
zeros <- filter(zip.train, V1==0)
```

a. Do a hierarchical clustering of these data using the ward.D method, plot the resulting dendogram and cut it into k=4 clusters
```{r}
dendo <- hclust(dist(zeros), method="ward.D")
plot(dendo)
dendo.4 <- cutree(dendo,4)
```

b. Plot the average digit at each cluster.
```{r}
summary(dendo.4)
```

c. Compute the principal components for this data set. Plot the scatterplot of the scores in the first two PCs, using a different color for points in different clusters.
```{r}
zip.PC <- princomp(zeros)
summary(zip.PC)
```

d. For each one of the k clusters obtained above, do the following tasks: (A unique plot should be done, at which the k densities are represented simultaneously)
• Consider the bivariate data set of the scores in PC1 and PC2 of the points in this cluster. 
• Estimate non-parametrically the joint density of (PC1,PC2), conditional to this cluster. Use the default bandwith values. 
• Represent the estimated bivariate density using the level curve that covers the 75% of the points in this cluster.
```{r}
```

e. Over the previous plot, represent the principal curve obtained from the 256-dimensional set of zeros using the package princurve.
```{r}
```

f. For each one of the k clusters obtained above, do the following tasks: (A unique scatter plot of the scores in PC1 and PC2 should be done, over which the k densities are represented simultaneously) 
• Consider the univariate data set of the lambda scores over the principal curve of the points in this cluster. 
• Estimate non-parametrically the density function of lambda, conditional to this cluster. Use the default bandwith value. 
• Plot the estimated density function. 
```{r}
```